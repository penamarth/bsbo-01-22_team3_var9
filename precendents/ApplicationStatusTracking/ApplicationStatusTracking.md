# AplicationStatusTracking.nd

## Прецедент: "Просмотр статуса заявки"

Информационная система технической экспертизы.

---

## Уровень
Задача, определенная системой.

---

## Основные исполнители
**Заявитель (Applicant) и Держатель фонда (FundHolder)**

---

## Заинтересованные лица и их требования

### 1. Заявитель (Applicant)
- Возможность просматривать актуальный статус своей заявки в любое время.
- Получение уведомлений о изменениях статуса заявки (например, при переходе на новый этап).
- Доступ к истории изменений статуса и комментариям, связанным с заявкой.

### 2. Держатель фонда (FundHolder)
- Возможность просматривать статус заявок, находящихся на рассмотрении или уже одобренных.
- Уведомление о любых изменениях в статусе заявок, которые могут требовать их внимания.
- Доступ к отчетам о состоянии всех заявок для принятия обоснованных решений.

### 3. Администратор системы
- Контроль за доступом пользователей к информации о статусе заявок.
- Логирование всех запросов на просмотр статуса для аудита и анализа использования системы.
- Обеспечение корректности отображаемой информации о статусах заявок.

### 4. Операционный менеджер (OperationalManager) (опционально)
- Анализ статистики обработки заявок и текущих статусов для оптимизации процессов.
- Доступ к отчетам по времени обработки заявок на разных этапах.

## Предусловия

1. Пользователь (заявитель или держатель фонда) авторизован в системе.
2. Заявка зарегистрирована в системе и связана с пользователем.
3. Статус заявки сохранён и доступен через `ApplicationManager`.

## Результаты (Постусловия)

1. Пользователь получил актуальный статус заявки.
2. Запрос на просмотр статуса заявки зафиксирован в системе через `ReportManager`.
3. Уведомление отправлено пользователю, если статус заявки изменился.

---

## Основной успешный сценарий

### 1. Авторизация пользователя
- Пользователь вводит свои учетные данные.
- Система проверяет данные и предоставляет доступ через `IApplicationManager`.

### 2. Запрос на просмотр статуса заявки
- Пользователь выбирает заявку, статус которой он хочет увидеть.
- Система запрашивает данные заявки через `IApplicationManager::getApplicationByID(applicationID)`.

### 3. Получение данных заявки
- Система возвращает объект `Application`, содержащий:
  - `ID`: уникальный идентификатор заявки.
  - `Title`: название заявки.
  - `Description`: описание заявки.
  - `Status`: текущий статус заявки.

### 4. Уведомление пользователя (при необходимости)
- Если статус заявки изменился с момента последнего запроса, система формирует объект `Notification`:
  - `Message`: текст уведомления о новом статусе.
  - `Recipient`: пользователь.
  - `Date`: дата уведомления.
- Уведомление отправляется через `NotificationManager::sendNotification`.

### 5. Логирование запроса
- Система фиксирует запрос пользователя через `ReportManager`:
  - `UserID`: идентификатор пользователя.
  - `Action`: описание действия ("Просмотр статуса заявки").
  - `Date`: дата и время запроса.

---

## Варианты альтернативных решений

### 1. Заявка не найдена
- Если `ApplicationManager::getApplicationByID(applicationID)` возвращает ошибку:
  - Система уведомляет пользователя: "Заявка с указанным ID не найдена."
  - Пользователь может повторить ввод или выбрать другую заявку.

### 2. Ошибка отправки уведомления
- Если `NotificationManager::sendNotification` возвращает ошибку:
  - Система фиксирует проблему через `ReportManager`.
  - Уведомление отправляется повторно при следующей возможности.

---

## Расширения

### 1. Просмотр нескольких заявок
- Пользователь может запросить статус нескольких заявок одновременно.
- Система возвращает список статусов через `ApplicationManager::getAllApplications`.

### 2. Автоматическая отправка уведомлений
- Пользователь подписывается на уведомления об изменении статуса заявки.
- При изменении статуса система отправляет уведомление через `NotificationManager`.

### 3. Генерация отчёта о статусах
- Держатель фонда может запросить отчёт о статусах всех заявок через `ReportManager::generateReport`.

---

## Специальные требования
1. Все запросы на просмотр статуса заявки фиксируются через `ReportManager`.
2. Уведомления о статусе заявки отправляются заявителю сразу после обновления статуса.
3. Информация о статусе заявки обновляется в системе не позднее 15 минут после изменения.

---

## Связь с диаграммой классов

1. **ApplicationManager**
   - Управляет заявками, позволяет получить статус заявки через `getApplicationByID`.

2. **NotificationManager**
   - Отправляет уведомления пользователям через метод `sendNotification`.

3. **ReportManager**
   - Логирует запросы на просмотр статусов через `generateReport`.
   - Формирует отчёты для анализа данных.