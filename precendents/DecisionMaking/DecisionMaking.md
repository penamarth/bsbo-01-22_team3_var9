# DecisionMaking.md

## Прецедент: "Принятие решения/пересмотр решения"

Информационная система технической экспертизы.

---

## Уровень
Задача, определенная системой.

---

## Основные исполнители
**Держатель фонда (FundHolder)**

---

## Заинтересованные лица и их требования

### 1. Держатель фонда (FundHolder)
- Возможность принимать решения по заявкам (одобрение, отклонение).
- Возможность пересматривать ранее принятые решения.
- Обоснование каждого решения через комментарии.

### 2. Заявитель (Applicant)
- Получение уведомления о принятом решении через `NotificationManager`.
- Прозрачность и обоснование решения (указанных в объекте `Decision`).

---

## Предусловия
1. Заявка зарегистрирована в системе.
2. Экспертная оценка заявки доступна через `ExpertiseManager`.
3. Пользователь авторизован как держатель фонда.

---

## Результаты (Постусловия)
1. Принятое решение зафиксировано в системе через `DecisionManager`.
2. Заявка обновлена с новым статусом через `ApplicationManager`.
3. Заявитель уведомлён о решении через `NotificationManager`.

---

## Основной успешный сценарий

### 1. Доступ к заявке
- Держатель фонда загружает данные заявки через `ApplicationManager::getApplicationByID(applicationID)`.
- Система возвращает объект заявки (`Application`), содержащий такие атрибуты, как:
  - `ID`: уникальный идентификатор заявки.
  - `Title`: название заявки.
  - `Description`: описание заявки.
  - `Status`: текущий статус заявки.

### 2. Получение оценки экспертов
- Держатель фонда запрашивает экспертные оценки заявки через `ExpertiseManager::getEvaluation(applicationID)`.
- Система возвращает объект `Evaluation`, содержащий:
  - `Score`: оценка заявки.
  - `Comments`: комментарии экспертов.
  - `Expert`: ссылка на эксперта.

### 3. Принятие решения
- Держатель фонда принимает решение через `DecisionManager::makeDecision(applicationID, decision)`.
- Система создаёт объект `Decision`, содержащий:
  - `ID`: уникальный идентификатор решения.
  - `DecisionType`: тип решения ("Одобрено" или "Отклонено").
  - `Reason`: причина принятого решения.
  - `Application`: ссылка на заявку.

### 4. Обновление статуса заявки
- Система обновляет статус заявки через `ApplicationManager::updateApplication(applicationID, updatedApplication)`.
- Новый статус заявки зависит от принятого решения:
  - "Одобрена" для одобренных заявок.
  - "Отклонена" для отклонённых заявок.

### 5. Уведомление заявителя
- Система отправляет уведомление заявителю через `NotificationManager::sendNotification(notification)`.
- Уведомление содержит:
  - `Message`: текст уведомления о решении.
  - `Recipient`: заявитель.
  - `Date`: дата уведомления.

---

## Варианты альтернативных решений

### 1. Пересмотр решения
- Держатель фонда инициирует пересмотр ранее принятого решения через `DecisionManager::reviewDecision(applicationID)`.
- Система обновляет объект `Decision` с новым типом решения.
- Заявка обновляется с новым статусом через `ApplicationManager`.
- Заявитель уведомляется о пересмотре решения.

### 2. Ошибка при сохранении решения
- Если `DecisionManager::makeDecision` возвращает ошибку:
  - Система фиксирует проблему.
  - Уведомляет держателя фонда о необходимости повторного действия.

### 3. Ошибка при отправке уведомления
- Если `NotificationManager::sendNotification` не отправляет уведомление:
  - Система фиксирует проблему и пытается повторить отправку уведомления.

### 4. Отмена принятия решения
- Если пользователь решает отменить действие до его завершения:
  - Система прерывает процесс.
  - Заявка остаётся с текущим статусом.

---

## Расширения

### 1.  Автоматическая аналитика
- Система генерирует отчёт по всем принятым решениям через `ReportManager::generateReport`.
- Отчёт включает статистику по типам решений, причинам и заявкам.

---


## Специальные требования
1. Уведомления отправляются заявителям в течение 1 часа после принятия решения.
2. Обоснования решений должны быть чёткими и понятными, чтобы избежать недоразумений.

---

## Связь с диаграммой классов

1. **ApplicationManager**
   - Управляет заявками, позволяет загружать данные и обновлять статус через `getApplicationByID` и `updateApplication`.

2. **ExpertiseManager**
   - Предоставляет доступ к оценкам экспертов через `getEvaluation`.

3. **DecisionManager**
   - Обрабатывает принятие решений через `makeDecision` и их пересмотр через `reviewDecision`.

4. **NotificationManager**
   - Отправляет уведомления заявителям через `sendNotification`.

---
